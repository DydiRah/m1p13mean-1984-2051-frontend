<div>
  <app-page-breadcrumb pageTitle="Items" />

  <!-- Success Message -->
  @if (success) {
  <div
    class="mb-4 rounded-lg bg-green-50 p-4 text-sm text-green-700 dark:bg-green-900/20 dark:text-green-400"
  >
    {{ success }}
  </div>
  }

  <!-- Error Message -->
  @if (error) {
  <div
    class="mb-4 rounded-lg bg-red-50 p-4 text-sm text-red-700 dark:bg-red-900/20 dark:text-red-400"
  >
    {{ error }}
  </div>
  }

  <!-- Header Section -->
  <div
    class="mb-6 flex items-center justify-between rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"
  >
    <div>
      <h2 class="text-2xl font-semibold text-gray-800 dark:text-white">
        Items Management
      </h2>
      <p class="text-sm text-gray-600 dark:text-gray-400">
        Manage your items inventory
      </p>
    </div>
    <app-button variant="primary" (btnClick)="openAddModal()">
      + Add New Item
    </app-button>
  </div>

  <!-- Table Section -->
  <div
    class="rounded-2xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"
  >
    @if (isLoading) {
    <div class="flex items-center justify-center p-12">
      <div class="text-center">
        <div
          class="mb-4 inline-block h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-brand-500 dark:border-gray-700 dark:border-t-brand-500"
        ></div>
        <p class="text-gray-600 dark:text-gray-400">Loading items...</p>
      </div>
    </div>
    } @else if (items.length === 0) {
    <div class="mx-auto w-full max-w-[630px] px-5 py-12 text-center xl:px-10">
      <h3 class="mb-4 font-semibold text-gray-800 text-theme-xl dark:text-white/90">
        No Items Found
      </h3>
      <p class="text-sm text-gray-500 dark:text-gray-400">
        Start by creating your first item.
      </p>
    </div>
    } @else {
    <div class="overflow-hidden">
      <div class="max-w-full overflow-x-auto">
        <table class="min-w-full">
          <!-- Table Header -->
          <thead class="border-b border-gray-100 dark:border-white/[0.05]">
            <tr>
              <th
                class="px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400"
              >
                Photo
              </th>
              <th
                class="px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400"
              >
                Name
              </th>
              <th
                class="px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400"
              >
                Description
              </th>
              <th
                class="px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400"
              >
                Category
              </th>
              <th
                class="px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400"
              >
                Price
              </th>
              <th
                class="px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400"
              >
                Actions
              </th>
            </tr>
          </thead>
          <!-- Table Body -->
          <tbody class="divide-y divide-gray-100 dark:divide-white/[0.05]">
            @for (item of items; track item._id) {
            <tr
              class="hover:bg-gray-50 transition-colors dark:hover:bg-white/[0.02]"
            >
              <td class="px-5 py-4 sm:px-6 text-start">
                @if (item.image_url) {
                <img src="{{ getImageUrl(item) }}" alt="{{ item.name }}" class="h-12 w-12 rounded object-cover" />
                } @else {
                <div class="h-12 w-12 rounded bg-gray-100 dark:bg-gray-800"></div>
                }
              </td>
              <td
                class="px-5 py-4 sm:px-6 text-start text-gray-800 dark:text-white/90"
              >
                <span class="font-medium">{{ item.name }}</span>
              </td>
              <td
                class="px-5 py-4 sm:px-6 text-start text-gray-600 dark:text-gray-400"
              >
                <span class="line-clamp-1">{{ item.description }}</span>
              </td>
              <td
                class="px-5 py-4 sm:px-6 text-start text-gray-600 dark:text-gray-400"
              >
                <app-badge size="sm" color="info">
                  {{ item.category }}
                </app-badge>
              </td>
              <td
                class="px-5 py-4 sm:px-6 text-start font-semibold text-gray-800 dark:text-white/90"
              >
                ${{ item.price | number : '1.2-2' }}
              </td>
              <td class="px-5 py-4 sm:px-6 text-start">
                <div class="flex items-center gap-2">
                  <button
                    (click)="openEditModal(item)"
                    class="rounded-lg bg-blue-50 px-3 py-2 text-sm font-medium text-blue-600 hover:bg-blue-100 dark:bg-blue-900/20 dark:text-blue-400 dark:hover:bg-blue-900/30 transition-colors"
                  >
                    Edit
                  </button>
                  <button
                    (click)="deleteItem(item._id)"
                    class="rounded-lg bg-red-50 px-3 py-2 text-sm font-medium text-red-600 hover:bg-red-100 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30 transition-colors"
                  >
                    Delete
                  </button>
                </div>
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
    }
  </div>

  <!-- Modal Component -->
  <app-item-form-modal></app-item-form-modal>

  <!-- Confirm Dialog Component -->
  <app-confirm-dialog></app-confirm-dialog>
</div>
